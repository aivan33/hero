{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Poker Scenario Config Schema",
  "description": "Schema for defining poker scenarios in educational content. All monetary values (pot size, bets, stacks, effectiveStack) are expressed in big blinds (BB), not chips.",
  "type": "object",
  "required": ["board", "hero", "players", "pot", "rangeMatrix", "effectiveStack"],
  "properties": {
    "board": {
      "type": "object",
      "description": "Community cards on the board",
      "required": ["street"],
      "properties": {
        "street": {
          "type": "string",
          "enum": ["preflop", "flop", "turn", "river"],
          "description": "Current street of action"
        },
        "cards": {
          "type": "array",
          "description": "Community cards (empty for preflop, 3 for flop, 4 for turn, 5 for river)",
          "items": {
            "type": "string",
            "pattern": "^[AKQJT98765432][shdc]$",
            "description": "Card in format: rank + suit (e.g., 'As' for Ace of spades)"
          },
          "minItems": 0,
          "maxItems": 5
        }
      }
    },
    "hero": {
      "type": "object",
      "description": "Hero player information",
      "required": ["position"],
      "properties": {
        "position": {
          "type": "string",
          "enum": ["UTG", "UTG+1", "UTG+2", "LJ", "HJ", "CO", "BTN", "SB", "BB"],
          "description": "Hero's position at the table"
        },
        "holeCards": {
          "type": "array",
          "description": "Hero's hole cards (optional, may be hidden)",
          "items": {
            "type": "string",
            "pattern": "^[AKQJT98765432][shdc]$"
          },
          "minItems": 2,
          "maxItems": 2
        },
        "stack": {
          "type": "number",
          "description": "Hero's remaining stack in big blinds",
          "minimum": 0
        }
      }
    },
    "players": {
      "type": "array",
      "description": "Array of opponent players (villains) in the hand",
      "items": {
        "type": "object",
        "required": ["position"],
        "properties": {
          "position": {
            "type": "string",
            "enum": ["UTG", "UTG+1", "UTG+2", "LJ", "HJ", "CO", "BTN", "SB", "BB"],
            "description": "Player's position at the table"
          },
          "stack": {
            "type": "number",
            "description": "Player's remaining stack in big blinds",
            "minimum": 0
          },
          "label": {
            "type": "string",
            "description": "Optional identifier for this player (e.g., 'villain1', 'villain2', 'BB')",
            "pattern": "^[a-zA-Z0-9_-]+$"
          }
        }
      },
      "minItems": 1
    },
    "effectiveStack": {
      "type": "number",
      "description": "Effective stack size in big blinds - the minimum of hero's stack and all active players' stacks. Represents the maximum amount that can be won/lost in the hand.",
      "minimum": 0
    },
    "pot": {
      "type": "object",
      "description": "Pot and betting information",
      "required": ["size"],
      "properties": {
        "size": {
          "type": "number",
          "description": "Current pot size in big blinds",
          "minimum": 0
        },
        "currentBet": {
          "type": "number",
          "description": "Current bet to call in big blinds (0 if no bet)",
          "minimum": 0,
          "default": 0
        }
      }
    },
    "rangeMatrix": {
      "type": "object",
      "description": "13x13 matrix showing hand frequencies. Pairs are on the diagonal, suited combos above the diagonal, offsuit combos below the diagonal.",
      "required": ["displayFor", "matrix", "matrixLabels"],
      "properties": {
        "displayFor": {
          "type": "string",
          "description": "Indicates whose range is being displayed (use player label from players array, or 'hero')"
        },
        "matrixLabels": {
          "type": "object",
          "description": "Explicit labels for rows and columns of the range matrix",
          "required": ["rows", "columns"],
          "properties": {
            "rows": {
              "type": "array",
              "description": "Row labels ordered from top to bottom: A, K, Q, J, T, 9, 8, 7, 6, 5, 4, 3, 2",
              "items": {
                "type": "string",
                "enum": ["A", "K", "Q", "J", "T", "9", "8", "7", "6", "5", "4", "3", "2"]
              },
              "minItems": 13,
              "maxItems": 13
            },
            "columns": {
              "type": "array",
              "description": "Column labels ordered from left to right: A, K, Q, J, T, 9, 8, 7, 6, 5, 4, 3, 2",
              "items": {
                "type": "string",
                "enum": ["A", "K", "Q", "J", "T", "9", "8", "7", "6", "5", "4", "3", "2"]
              },
              "minItems": 13,
              "maxItems": 13
            }
          }
        },
        "matrix": {
          "type": "array",
          "description": "13x13 matrix of hand frequencies (0-1). Matrix[i][j] where i=row, j=column. When i=j: pairs. When i<j: suited. When i>j: offsuit.",
          "items": {
            "type": "array",
            "items": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            },
            "minItems": 13,
            "maxItems": 13
          },
          "minItems": 13,
          "maxItems": 13
        },
        "colorScheme": {
          "type": "string",
          "enum": ["default", "heatmap", "binary", "custom"],
          "description": "Color scheme for visualizing frequencies",
          "default": "default"
        }
      }
    },
    "actionHistory": {
      "type": "array",
      "description": "Optional sequence of actions leading to current state",
      "items": {
        "type": "object",
        "required": ["street", "player", "action"],
        "properties": {
          "street": {
            "type": "string",
            "enum": ["preflop", "flop", "turn", "river"]
          },
          "player": {
            "type": "string",
            "enum": ["hero", "villain", "other"],
            "description": "Player making the action"
          },
          "action": {
            "type": "string",
            "enum": ["fold", "check", "call", "bet", "raise", "allin"],
            "description": "Action type"
          },
          "amount": {
            "type": "number",
            "description": "Bet/raise amount in big blinds (required for bet/raise/allin)",
            "minimum": 0
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Optional metadata for the scenario",
      "properties": {
        "title": {
          "type": "string",
          "description": "Title or description of the scenario"
        },
        "difficulty": {
          "type": "string",
          "enum": ["beginner", "intermediate", "advanced"],
          "description": "Difficulty level for educational content"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Tags for categorizing scenarios (e.g., '3bet', 'cbet', 'bluff')"
        }
      }
    }
  }
}
